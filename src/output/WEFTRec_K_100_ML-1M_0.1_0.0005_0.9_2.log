2025-10-23 20:58:39,340 - Namespace(data_dir='./data/', output_dir='output/', data_name='ML-1M', do_eval=False, load_model=None, train_name='WEFTRec_K_100_ML-1M_0.1_0.0005_0.9_2.log', num_items=10, num_users=6041, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=0, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='WEARec', max_seq_length=100, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.1, initializer_range=0.02, num_heads=2, alpha=0.9, cuda_condition=True, data_file='./data/ML-1M.txt', item_size=3417, checkpoint_path='output/WEFTRec_K_100_ML-1M_0.1_0.0005_0.9_2.log.pt', same_target_path='./data/ML-1M_same_target.npy')
2025-10-23 20:58:39,350 - WEARecModel(
  (item_embeddings): Embedding(3417, 64, padding_idx=0)
  (position_embeddings): Embedding(100, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.1, inplace=False)
  (item_encoder): WEARecEncoder(
    (blocks): ModuleList(
      (0-1): 2 x WEARecBlock(
        (layer): WEARecLayer(
          (adaptive_mlp): Sequential(
            (0): Linear(in_features=64, out_features=64, bias=True)
            (1): GELU(approximate='none')
            (2): Linear(in_features=64, out_features=204, bias=True)
          )
          (out_dropout): Dropout(p=0.1, inplace=False)
          (LayerNorm): LayerNorm()
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
)
2025-10-23 20:58:45,089 - Total Parameters: 333554
2025-10-23 20:59:37,900 - {'epoch': 0, 'rec_loss': '6.7052'}
2025-10-23 20:59:38,821 - {'Epoch': 0, 'HR@5': '0.1593', 'NDCG@5': '0.1044', 'HR@10': '0.2328', 'NDCG@10': '0.1280', 'HR@20': '0.3316', 'NDCG@20': '0.1529'}
2025-10-23 20:59:38,822 - Validation score increased.  Saving model ...
2025-10-23 21:00:30,307 - {'epoch': 1, 'rec_loss': '5.9051'}
2025-10-23 21:00:31,233 - {'Epoch': 1, 'HR@5': '0.1858', 'NDCG@5': '0.1213', 'HR@10': '0.2772', 'NDCG@10': '0.1506', 'HR@20': '0.3889', 'NDCG@20': '0.1788'}
2025-10-23 21:00:31,233 - Validation score increased.  Saving model ...
2025-10-23 21:01:23,996 - {'epoch': 2, 'rec_loss': '5.7273'}
2025-10-23 21:01:24,895 - {'Epoch': 2, 'HR@5': '0.1874', 'NDCG@5': '0.1266', 'HR@10': '0.2868', 'NDCG@10': '0.1585', 'HR@20': '0.4041', 'NDCG@20': '0.1881'}
2025-10-23 21:01:24,895 - Validation score increased.  Saving model ...
2025-10-23 21:02:16,980 - {'epoch': 3, 'rec_loss': '5.6400'}
2025-10-23 21:02:17,979 - {'Epoch': 3, 'HR@5': '0.2010', 'NDCG@5': '0.1329', 'HR@10': '0.3038', 'NDCG@10': '0.1660', 'HR@20': '0.4157', 'NDCG@20': '0.1944'}
2025-10-23 21:02:17,980 - Validation score increased.  Saving model ...
2025-10-23 21:03:09,172 - {'epoch': 4, 'rec_loss': '5.5865'}
2025-10-23 21:03:10,151 - {'Epoch': 4, 'HR@5': '0.1987', 'NDCG@5': '0.1313', 'HR@10': '0.3008', 'NDCG@10': '0.1640', 'HR@20': '0.4149', 'NDCG@20': '0.1928'}
2025-10-23 21:03:10,152 - EarlyStopping counter: 1 out of 10
2025-10-23 21:04:00,669 - {'epoch': 5, 'rec_loss': '5.5475'}
2025-10-23 21:04:01,700 - {'Epoch': 5, 'HR@5': '0.2031', 'NDCG@5': '0.1342', 'HR@10': '0.3013', 'NDCG@10': '0.1660', 'HR@20': '0.4207', 'NDCG@20': '0.1961'}
2025-10-23 21:04:01,701 - Validation score increased.  Saving model ...
2025-10-23 21:04:52,380 - {'epoch': 6, 'rec_loss': '5.5151'}
2025-10-23 21:04:53,376 - {'Epoch': 6, 'HR@5': '0.2066', 'NDCG@5': '0.1357', 'HR@10': '0.3116', 'NDCG@10': '0.1696', 'HR@20': '0.4296', 'NDCG@20': '0.1994'}
2025-10-23 21:04:53,377 - Validation score increased.  Saving model ...
2025-10-23 21:05:44,135 - {'epoch': 7, 'rec_loss': '5.4891'}
2025-10-23 21:05:45,110 - {'Epoch': 7, 'HR@5': '0.2154', 'NDCG@5': '0.1427', 'HR@10': '0.3146', 'NDCG@10': '0.1747', 'HR@20': '0.4273', 'NDCG@20': '0.2032'}
2025-10-23 21:05:45,111 - Validation score increased.  Saving model ...
2025-10-23 21:06:36,778 - {'epoch': 8, 'rec_loss': '5.4669'}
2025-10-23 21:06:37,747 - {'Epoch': 8, 'HR@5': '0.2132', 'NDCG@5': '0.1420', 'HR@10': '0.3127', 'NDCG@10': '0.1741', 'HR@20': '0.4326', 'NDCG@20': '0.2043'}
2025-10-23 21:06:37,748 - Validation score increased.  Saving model ...
2025-10-23 21:07:29,815 - {'epoch': 9, 'rec_loss': '5.4453'}
2025-10-23 21:07:30,772 - {'Epoch': 9, 'HR@5': '0.2157', 'NDCG@5': '0.1431', 'HR@10': '0.3132', 'NDCG@10': '0.1747', 'HR@20': '0.4311', 'NDCG@20': '0.2045'}
2025-10-23 21:07:30,773 - Validation score increased.  Saving model ...
2025-10-23 21:08:22,119 - {'epoch': 10, 'rec_loss': '5.4271'}
2025-10-23 21:08:23,093 - {'Epoch': 10, 'HR@5': '0.2177', 'NDCG@5': '0.1453', 'HR@10': '0.3161', 'NDCG@10': '0.1770', 'HR@20': '0.4305', 'NDCG@20': '0.2059'}
2025-10-23 21:08:23,093 - Validation score increased.  Saving model ...
2025-10-23 21:09:14,630 - {'epoch': 11, 'rec_loss': '5.4104'}
2025-10-23 21:09:15,545 - {'Epoch': 11, 'HR@5': '0.2222', 'NDCG@5': '0.1480', 'HR@10': '0.3240', 'NDCG@10': '0.1806', 'HR@20': '0.4373', 'NDCG@20': '0.2092'}
2025-10-23 21:09:15,545 - Validation score increased.  Saving model ...
2025-10-23 21:10:08,977 - {'epoch': 12, 'rec_loss': '5.3942'}
2025-10-23 21:10:09,919 - {'Epoch': 12, 'HR@5': '0.2209', 'NDCG@5': '0.1469', 'HR@10': '0.3199', 'NDCG@10': '0.1788', 'HR@20': '0.4348', 'NDCG@20': '0.2078'}
2025-10-23 21:10:09,920 - EarlyStopping counter: 1 out of 10
2025-10-23 21:11:01,919 - {'epoch': 13, 'rec_loss': '5.3805'}
2025-10-23 21:11:02,878 - {'Epoch': 13, 'HR@5': '0.2235', 'NDCG@5': '0.1496', 'HR@10': '0.3242', 'NDCG@10': '0.1821', 'HR@20': '0.4427', 'NDCG@20': '0.2120'}
2025-10-23 21:11:02,878 - Validation score increased.  Saving model ...
2025-10-23 21:11:53,698 - {'epoch': 14, 'rec_loss': '5.3686'}
2025-10-23 21:11:54,704 - {'Epoch': 14, 'HR@5': '0.2248', 'NDCG@5': '0.1484', 'HR@10': '0.3224', 'NDCG@10': '0.1798', 'HR@20': '0.4366', 'NDCG@20': '0.2087'}
2025-10-23 21:11:54,705 - EarlyStopping counter: 1 out of 10
2025-10-23 21:12:47,476 - {'epoch': 15, 'rec_loss': '5.3577'}
2025-10-23 21:12:48,451 - {'Epoch': 15, 'HR@5': '0.2210', 'NDCG@5': '0.1492', 'HR@10': '0.3180', 'NDCG@10': '0.1805', 'HR@20': '0.4399', 'NDCG@20': '0.2112'}
2025-10-23 21:12:48,452 - EarlyStopping counter: 2 out of 10
2025-10-23 21:13:40,327 - {'epoch': 16, 'rec_loss': '5.3475'}
2025-10-23 21:13:41,296 - {'Epoch': 16, 'HR@5': '0.2255', 'NDCG@5': '0.1514', 'HR@10': '0.3235', 'NDCG@10': '0.1830', 'HR@20': '0.4402', 'NDCG@20': '0.2125'}
2025-10-23 21:13:41,297 - Validation score increased.  Saving model ...
2025-10-23 21:14:33,884 - {'epoch': 17, 'rec_loss': '5.3382'}
2025-10-23 21:14:34,830 - {'Epoch': 17, 'HR@5': '0.2258', 'NDCG@5': '0.1525', 'HR@10': '0.3222', 'NDCG@10': '0.1838', 'HR@20': '0.4382', 'NDCG@20': '0.2131'}
2025-10-23 21:14:34,830 - Validation score increased.  Saving model ...
2025-10-23 21:15:27,210 - {'epoch': 18, 'rec_loss': '5.3287'}
2025-10-23 21:15:28,206 - {'Epoch': 18, 'HR@5': '0.2275', 'NDCG@5': '0.1539', 'HR@10': '0.3263', 'NDCG@10': '0.1860', 'HR@20': '0.4369', 'NDCG@20': '0.2140'}
2025-10-23 21:15:28,207 - Validation score increased.  Saving model ...
2025-10-23 21:16:19,812 - {'epoch': 19, 'rec_loss': '5.3197'}
2025-10-23 21:16:20,765 - {'Epoch': 19, 'HR@5': '0.2258', 'NDCG@5': '0.1508', 'HR@10': '0.3268', 'NDCG@10': '0.1834', 'HR@20': '0.4421', 'NDCG@20': '0.2126'}
2025-10-23 21:16:20,765 - EarlyStopping counter: 1 out of 10
2025-10-23 21:17:13,325 - {'epoch': 20, 'rec_loss': '5.3126'}
2025-10-23 21:17:14,317 - {'Epoch': 20, 'HR@5': '0.2296', 'NDCG@5': '0.1545', 'HR@10': '0.3258', 'NDCG@10': '0.1855', 'HR@20': '0.4432', 'NDCG@20': '0.2152'}
2025-10-23 21:17:14,317 - Validation score increased.  Saving model ...
2025-10-23 21:18:05,331 - {'epoch': 21, 'rec_loss': '5.3056'}
2025-10-23 21:18:06,304 - {'Epoch': 21, 'HR@5': '0.2278', 'NDCG@5': '0.1542', 'HR@10': '0.3267', 'NDCG@10': '0.1861', 'HR@20': '0.4444', 'NDCG@20': '0.2158'}
2025-10-23 21:18:06,304 - Validation score increased.  Saving model ...
2025-10-23 21:18:57,416 - {'epoch': 22, 'rec_loss': '5.2991'}
2025-10-23 21:18:58,413 - {'Epoch': 22, 'HR@5': '0.2306', 'NDCG@5': '0.1545', 'HR@10': '0.3336', 'NDCG@10': '0.1877', 'HR@20': '0.4425', 'NDCG@20': '0.2153'}
2025-10-23 21:18:58,414 - EarlyStopping counter: 1 out of 10
2025-10-23 21:19:49,301 - {'epoch': 23, 'rec_loss': '5.2913'}
2025-10-23 21:19:50,231 - {'Epoch': 23, 'HR@5': '0.2338', 'NDCG@5': '0.1566', 'HR@10': '0.3286', 'NDCG@10': '0.1871', 'HR@20': '0.4437', 'NDCG@20': '0.2161'}
2025-10-23 21:19:50,231 - Validation score increased.  Saving model ...
2025-10-23 21:20:42,012 - {'epoch': 24, 'rec_loss': '5.2873'}
2025-10-23 21:20:43,042 - {'Epoch': 24, 'HR@5': '0.2276', 'NDCG@5': '0.1545', 'HR@10': '0.3320', 'NDCG@10': '0.1882', 'HR@20': '0.4412', 'NDCG@20': '0.2158'}
2025-10-23 21:20:43,043 - EarlyStopping counter: 1 out of 10
2025-10-23 21:21:33,943 - {'epoch': 25, 'rec_loss': '5.2814'}
2025-10-23 21:21:34,887 - {'Epoch': 25, 'HR@5': '0.2300', 'NDCG@5': '0.1530', 'HR@10': '0.3310', 'NDCG@10': '0.1856', 'HR@20': '0.4449', 'NDCG@20': '0.2143'}
2025-10-23 21:21:34,888 - EarlyStopping counter: 2 out of 10
2025-10-23 21:22:26,032 - {'epoch': 26, 'rec_loss': '5.2747'}
2025-10-23 21:22:27,267 - {'Epoch': 26, 'HR@5': '0.2368', 'NDCG@5': '0.1582', 'HR@10': '0.3363', 'NDCG@10': '0.1902', 'HR@20': '0.4470', 'NDCG@20': '0.2183'}
2025-10-23 21:22:27,268 - Validation score increased.  Saving model ...
2025-10-23 21:23:18,475 - {'epoch': 27, 'rec_loss': '5.2698'}
2025-10-23 21:23:19,401 - {'Epoch': 27, 'HR@5': '0.2315', 'NDCG@5': '0.1559', 'HR@10': '0.3341', 'NDCG@10': '0.1891', 'HR@20': '0.4507', 'NDCG@20': '0.2185'}
2025-10-23 21:23:19,401 - Validation score increased.  Saving model ...
2025-10-23 21:24:11,319 - {'epoch': 28, 'rec_loss': '5.2649'}
2025-10-23 21:24:12,253 - {'Epoch': 28, 'HR@5': '0.2323', 'NDCG@5': '0.1565', 'HR@10': '0.3303', 'NDCG@10': '0.1882', 'HR@20': '0.4447', 'NDCG@20': '0.2172'}
2025-10-23 21:24:12,254 - EarlyStopping counter: 1 out of 10
2025-10-23 21:25:04,777 - {'epoch': 29, 'rec_loss': '5.2593'}
2025-10-23 21:25:05,718 - {'Epoch': 29, 'HR@5': '0.2349', 'NDCG@5': '0.1573', 'HR@10': '0.3308', 'NDCG@10': '0.1882', 'HR@20': '0.4459', 'NDCG@20': '0.2173'}
2025-10-23 21:25:05,719 - EarlyStopping counter: 2 out of 10
2025-10-23 21:25:58,090 - {'epoch': 30, 'rec_loss': '5.2557'}
2025-10-23 21:25:59,109 - {'Epoch': 30, 'HR@5': '0.2316', 'NDCG@5': '0.1558', 'HR@10': '0.3320', 'NDCG@10': '0.1881', 'HR@20': '0.4425', 'NDCG@20': '0.2160'}
2025-10-23 21:25:59,109 - EarlyStopping counter: 3 out of 10
2025-10-23 21:26:51,030 - {'epoch': 31, 'rec_loss': '5.2535'}
2025-10-23 21:26:52,002 - {'Epoch': 31, 'HR@5': '0.2331', 'NDCG@5': '0.1584', 'HR@10': '0.3339', 'NDCG@10': '0.1909', 'HR@20': '0.4464', 'NDCG@20': '0.2194'}
2025-10-23 21:26:52,003 - Validation score increased.  Saving model ...
2025-10-23 21:27:44,029 - {'epoch': 32, 'rec_loss': '5.2478'}
2025-10-23 21:27:44,954 - {'Epoch': 32, 'HR@5': '0.2295', 'NDCG@5': '0.1560', 'HR@10': '0.3331', 'NDCG@10': '0.1893', 'HR@20': '0.4467', 'NDCG@20': '0.2180'}
2025-10-23 21:27:44,955 - EarlyStopping counter: 1 out of 10
2025-10-23 21:28:35,907 - {'epoch': 33, 'rec_loss': '5.2421'}
2025-10-23 21:28:36,888 - {'Epoch': 33, 'HR@5': '0.2308', 'NDCG@5': '0.1562', 'HR@10': '0.3363', 'NDCG@10': '0.1901', 'HR@20': '0.4465', 'NDCG@20': '0.2179'}
2025-10-23 21:28:36,888 - EarlyStopping counter: 2 out of 10
2025-10-23 21:29:28,692 - {'epoch': 34, 'rec_loss': '5.2397'}
2025-10-23 21:29:29,585 - {'Epoch': 34, 'HR@5': '0.2348', 'NDCG@5': '0.1590', 'HR@10': '0.3341', 'NDCG@10': '0.1910', 'HR@20': '0.4482', 'NDCG@20': '0.2198'}
2025-10-23 21:29:29,586 - Validation score increased.  Saving model ...
2025-10-23 21:30:16,803 - {'epoch': 35, 'rec_loss': '5.2357'}
2025-10-23 21:30:17,723 - {'Epoch': 35, 'HR@5': '0.2311', 'NDCG@5': '0.1568', 'HR@10': '0.3315', 'NDCG@10': '0.1893', 'HR@20': '0.4432', 'NDCG@20': '0.2175'}
2025-10-23 21:30:17,723 - EarlyStopping counter: 1 out of 10
2025-10-23 21:31:09,592 - {'epoch': 36, 'rec_loss': '5.2313'}
2025-10-23 21:31:10,567 - {'Epoch': 36, 'HR@5': '0.2326', 'NDCG@5': '0.1581', 'HR@10': '0.3368', 'NDCG@10': '0.1917', 'HR@20': '0.4445', 'NDCG@20': '0.2189'}
2025-10-23 21:31:10,567 - EarlyStopping counter: 2 out of 10
2025-10-23 21:32:01,396 - {'epoch': 37, 'rec_loss': '5.2294'}
2025-10-23 21:32:02,580 - {'Epoch': 37, 'HR@5': '0.2343', 'NDCG@5': '0.1590', 'HR@10': '0.3348', 'NDCG@10': '0.1913', 'HR@20': '0.4454', 'NDCG@20': '0.2193'}
2025-10-23 21:32:02,580 - EarlyStopping counter: 3 out of 10
2025-10-23 21:32:54,022 - {'epoch': 38, 'rec_loss': '5.2257'}
2025-10-23 21:32:54,971 - {'Epoch': 38, 'HR@5': '0.2308', 'NDCG@5': '0.1573', 'HR@10': '0.3286', 'NDCG@10': '0.1890', 'HR@20': '0.4422', 'NDCG@20': '0.2177'}
2025-10-23 21:32:54,971 - EarlyStopping counter: 4 out of 10
2025-10-23 21:33:47,476 - {'epoch': 39, 'rec_loss': '5.2234'}
2025-10-23 21:33:48,406 - {'Epoch': 39, 'HR@5': '0.2291', 'NDCG@5': '0.1553', 'HR@10': '0.3290', 'NDCG@10': '0.1875', 'HR@20': '0.4437', 'NDCG@20': '0.2165'}
2025-10-23 21:33:48,406 - EarlyStopping counter: 5 out of 10
2025-10-23 21:34:41,041 - {'epoch': 40, 'rec_loss': '5.2182'}
2025-10-23 21:34:42,010 - {'Epoch': 40, 'HR@5': '0.2326', 'NDCG@5': '0.1567', 'HR@10': '0.3346', 'NDCG@10': '0.1896', 'HR@20': '0.4460', 'NDCG@20': '0.2177'}
2025-10-23 21:34:42,011 - EarlyStopping counter: 6 out of 10
2025-10-23 21:35:33,659 - {'epoch': 41, 'rec_loss': '5.2154'}
2025-10-23 21:35:34,578 - {'Epoch': 41, 'HR@5': '0.2334', 'NDCG@5': '0.1578', 'HR@10': '0.3308', 'NDCG@10': '0.1892', 'HR@20': '0.4440', 'NDCG@20': '0.2178'}
2025-10-23 21:35:34,578 - EarlyStopping counter: 7 out of 10
2025-10-23 21:36:26,500 - {'epoch': 42, 'rec_loss': '5.2137'}
2025-10-23 21:36:27,447 - {'Epoch': 42, 'HR@5': '0.2318', 'NDCG@5': '0.1574', 'HR@10': '0.3326', 'NDCG@10': '0.1901', 'HR@20': '0.4432', 'NDCG@20': '0.2179'}
2025-10-23 21:36:27,448 - EarlyStopping counter: 8 out of 10
2025-10-23 21:37:19,772 - {'epoch': 43, 'rec_loss': '5.2108'}
2025-10-23 21:37:20,729 - {'Epoch': 43, 'HR@5': '0.2278', 'NDCG@5': '0.1535', 'HR@10': '0.3301', 'NDCG@10': '0.1865', 'HR@20': '0.4452', 'NDCG@20': '0.2156'}
2025-10-23 21:37:20,729 - EarlyStopping counter: 9 out of 10
2025-10-23 21:38:11,617 - {'epoch': 44, 'rec_loss': '5.2061'}
2025-10-23 21:38:12,553 - {'Epoch': 44, 'HR@5': '0.2300', 'NDCG@5': '0.1571', 'HR@10': '0.3334', 'NDCG@10': '0.1904', 'HR@20': '0.4445', 'NDCG@20': '0.2185'}
2025-10-23 21:38:12,554 - EarlyStopping counter: 10 out of 10
2025-10-23 21:38:12,554 - Early stopping
2025-10-23 21:38:12,554 - ---------------Test Score---------------
2025-10-23 21:38:13,528 - {'Epoch': 0, 'HR@5': '0.2222', 'NDCG@5': '0.1510', 'HR@10': '0.3180', 'NDCG@10': '0.1819', 'HR@20': '0.4175', 'NDCG@20': '0.2069'}
2025-10-23 21:38:13,528 - WEFTRec_K_100_ML-1M_0.1_0.0005_0.9_2.log
2025-10-23 21:38:13,528 - {'Epoch': 0, 'HR@5': '0.2222', 'NDCG@5': '0.1510', 'HR@10': '0.3180', 'NDCG@10': '0.1819', 'HR@20': '0.4175', 'NDCG@20': '0.2069'}
