2025-10-24 11:57:50,575 - Namespace(data_dir='./data/', output_dir='output/', data_name='ML-1M', do_eval=False, load_model=None, train_name='WEFTRec_K_200_ML-1M_0.1_0.0005_0.6_8.log', num_items=10, num_users=6041, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=0, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='WEARec', max_seq_length=200, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.1, initializer_range=0.02, num_heads=8, alpha=0.6, cuda_condition=True, data_file='./data/ML-1M.txt', item_size=3417, checkpoint_path='output/WEFTRec_K_200_ML-1M_0.1_0.0005_0.6_8.log.pt', same_target_path='./data/ML-1M_same_target.npy')
2025-10-24 11:57:50,640 - WEARecModel(
  (item_embeddings): Embedding(3417, 64, padding_idx=0)
  (position_embeddings): Embedding(200, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.1, inplace=False)
  (item_encoder): WEARecEncoder(
    (blocks): ModuleList(
      (0-1): 2 x WEARecBlock(
        (layer): WEARecLayer(
          (adaptive_mlp): Sequential(
            (0): Linear(in_features=64, out_features=64, bias=True)
            (1): GELU(approximate='none')
            (2): Linear(in_features=64, out_features=1616, bias=True)
          )
          (out_dropout): Dropout(p=0.1, inplace=False)
          (LayerNorm): LayerNorm()
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
)
2025-10-24 11:58:00,100 - Total Parameters: 532738
2025-10-24 12:02:53,106 - {'epoch': 0, 'rec_loss': '6.4676'}
2025-10-24 12:02:54,835 - {'Epoch': 0, 'HR@5': '0.1795', 'NDCG@5': '0.1154', 'HR@10': '0.2636', 'NDCG@10': '0.1425', 'HR@20': '0.3733', 'NDCG@20': '0.1702'}
2025-10-24 12:02:54,836 - Validation score increased.  Saving model ...
2025-10-24 12:07:47,803 - {'epoch': 1, 'rec_loss': '5.7663'}
2025-10-24 12:07:49,575 - {'Epoch': 1, 'HR@5': '0.1897', 'NDCG@5': '0.1239', 'HR@10': '0.2906', 'NDCG@10': '0.1563', 'HR@20': '0.4081', 'NDCG@20': '0.1860'}
2025-10-24 12:07:49,575 - Validation score increased.  Saving model ...
2025-10-24 12:12:40,334 - {'epoch': 2, 'rec_loss': '5.6301'}
2025-10-24 12:12:42,060 - {'Epoch': 2, 'HR@5': '0.2025', 'NDCG@5': '0.1334', 'HR@10': '0.3071', 'NDCG@10': '0.1669', 'HR@20': '0.4194', 'NDCG@20': '0.1952'}
2025-10-24 12:12:42,061 - Validation score increased.  Saving model ...
2025-10-24 12:17:35,176 - {'epoch': 3, 'rec_loss': '5.5618'}
2025-10-24 12:17:36,997 - {'Epoch': 3, 'HR@5': '0.2073', 'NDCG@5': '0.1391', 'HR@10': '0.3066', 'NDCG@10': '0.1711', 'HR@20': '0.4263', 'NDCG@20': '0.2014'}
2025-10-24 12:17:36,998 - Validation score increased.  Saving model ...
2025-10-24 12:22:24,114 - {'epoch': 4, 'rec_loss': '5.5171'}
2025-10-24 12:22:25,817 - {'Epoch': 4, 'HR@5': '0.2116', 'NDCG@5': '0.1424', 'HR@10': '0.3149', 'NDCG@10': '0.1756', 'HR@20': '0.4379', 'NDCG@20': '0.2068'}
2025-10-24 12:22:25,818 - Validation score increased.  Saving model ...
2025-10-24 12:27:17,274 - {'epoch': 5, 'rec_loss': '5.4821'}
2025-10-24 12:27:18,981 - {'Epoch': 5, 'HR@5': '0.2159', 'NDCG@5': '0.1454', 'HR@10': '0.3171', 'NDCG@10': '0.1780', 'HR@20': '0.4338', 'NDCG@20': '0.2075'}
2025-10-24 12:27:18,981 - Validation score increased.  Saving model ...
2025-10-24 12:32:09,263 - {'epoch': 6, 'rec_loss': '5.4528'}
2025-10-24 12:32:10,976 - {'Epoch': 6, 'HR@5': '0.2209', 'NDCG@5': '0.1490', 'HR@10': '0.3195', 'NDCG@10': '0.1809', 'HR@20': '0.4396', 'NDCG@20': '0.2111'}
2025-10-24 12:32:10,976 - Validation score increased.  Saving model ...
2025-10-24 12:37:02,286 - {'epoch': 7, 'rec_loss': '5.4271'}
2025-10-24 12:37:04,038 - {'Epoch': 7, 'HR@5': '0.2235', 'NDCG@5': '0.1516', 'HR@10': '0.3238', 'NDCG@10': '0.1842', 'HR@20': '0.4447', 'NDCG@20': '0.2147'}
2025-10-24 12:37:04,038 - Validation score increased.  Saving model ...
2025-10-24 12:41:56,026 - {'epoch': 8, 'rec_loss': '5.4039'}
2025-10-24 12:41:57,766 - {'Epoch': 8, 'HR@5': '0.2288', 'NDCG@5': '0.1534', 'HR@10': '0.3263', 'NDCG@10': '0.1848', 'HR@20': '0.4406', 'NDCG@20': '0.2136'}
2025-10-24 12:41:57,766 - EarlyStopping counter: 1 out of 10
2025-10-24 12:46:41,046 - {'epoch': 9, 'rec_loss': '5.3848'}
2025-10-24 12:46:42,797 - {'Epoch': 9, 'HR@5': '0.2288', 'NDCG@5': '0.1542', 'HR@10': '0.3310', 'NDCG@10': '0.1871', 'HR@20': '0.4465', 'NDCG@20': '0.2162'}
2025-10-24 12:46:42,797 - Validation score increased.  Saving model ...
2025-10-24 12:51:32,286 - {'epoch': 10, 'rec_loss': '5.3675'}
2025-10-24 12:51:34,102 - {'Epoch': 10, 'HR@5': '0.2308', 'NDCG@5': '0.1564', 'HR@10': '0.3285', 'NDCG@10': '0.1879', 'HR@20': '0.4449', 'NDCG@20': '0.2174'}
2025-10-24 12:51:34,103 - Validation score increased.  Saving model ...
2025-10-24 12:56:24,654 - {'epoch': 11, 'rec_loss': '5.3536'}
2025-10-24 12:56:26,395 - {'Epoch': 11, 'HR@5': '0.2349', 'NDCG@5': '0.1587', 'HR@10': '0.3364', 'NDCG@10': '0.1914', 'HR@20': '0.4464', 'NDCG@20': '0.2192'}
2025-10-24 12:56:26,395 - Validation score increased.  Saving model ...
2025-10-24 13:01:16,924 - {'epoch': 12, 'rec_loss': '5.3405'}
2025-10-24 13:01:18,694 - {'Epoch': 12, 'HR@5': '0.2263', 'NDCG@5': '0.1529', 'HR@10': '0.3293', 'NDCG@10': '0.1860', 'HR@20': '0.4487', 'NDCG@20': '0.2160'}
2025-10-24 13:01:18,694 - EarlyStopping counter: 1 out of 10
2025-10-24 13:06:10,260 - {'epoch': 13, 'rec_loss': '5.3291'}
2025-10-24 13:06:11,970 - {'Epoch': 13, 'HR@5': '0.2353', 'NDCG@5': '0.1608', 'HR@10': '0.3376', 'NDCG@10': '0.1937', 'HR@20': '0.4467', 'NDCG@20': '0.2212'}
2025-10-24 13:06:11,971 - Validation score increased.  Saving model ...
2025-10-24 13:11:02,062 - {'epoch': 14, 'rec_loss': '5.3199'}
2025-10-24 13:11:03,779 - {'Epoch': 14, 'HR@5': '0.2376', 'NDCG@5': '0.1606', 'HR@10': '0.3366', 'NDCG@10': '0.1925', 'HR@20': '0.4493', 'NDCG@20': '0.2209'}
2025-10-24 13:11:03,779 - EarlyStopping counter: 1 out of 10
2025-10-24 13:15:53,650 - {'epoch': 15, 'rec_loss': '5.3111'}
2025-10-24 13:15:55,496 - {'Epoch': 15, 'HR@5': '0.2368', 'NDCG@5': '0.1597', 'HR@10': '0.3389', 'NDCG@10': '0.1928', 'HR@20': '0.4520', 'NDCG@20': '0.2214'}
2025-10-24 13:15:55,496 - Validation score increased.  Saving model ...
2025-10-24 13:20:47,798 - {'epoch': 16, 'rec_loss': '5.3029'}
2025-10-24 13:20:49,610 - {'Epoch': 16, 'HR@5': '0.2364', 'NDCG@5': '0.1603', 'HR@10': '0.3389', 'NDCG@10': '0.1933', 'HR@20': '0.4578', 'NDCG@20': '0.2232'}
2025-10-24 13:20:49,611 - Validation score increased.  Saving model ...
2025-10-24 13:25:39,480 - {'epoch': 17, 'rec_loss': '5.2944'}
2025-10-24 13:25:41,603 - {'Epoch': 17, 'HR@5': '0.2329', 'NDCG@5': '0.1582', 'HR@10': '0.3382', 'NDCG@10': '0.1922', 'HR@20': '0.4550', 'NDCG@20': '0.2215'}
2025-10-24 13:25:41,604 - EarlyStopping counter: 1 out of 10
2025-10-24 13:30:26,960 - {'epoch': 18, 'rec_loss': '5.2875'}
2025-10-24 13:30:28,674 - {'Epoch': 18, 'HR@5': '0.2394', 'NDCG@5': '0.1623', 'HR@10': '0.3397', 'NDCG@10': '0.1947', 'HR@20': '0.4561', 'NDCG@20': '0.2242'}
2025-10-24 13:30:28,675 - Validation score increased.  Saving model ...
2025-10-24 13:35:17,905 - {'epoch': 19, 'rec_loss': '5.2812'}
2025-10-24 13:35:19,592 - {'Epoch': 19, 'HR@5': '0.2396', 'NDCG@5': '0.1620', 'HR@10': '0.3417', 'NDCG@10': '0.1949', 'HR@20': '0.4545', 'NDCG@20': '0.2234'}
2025-10-24 13:35:19,592 - EarlyStopping counter: 1 out of 10
2025-10-24 13:40:10,231 - {'epoch': 20, 'rec_loss': '5.2750'}
2025-10-24 13:40:11,961 - {'Epoch': 20, 'HR@5': '0.2351', 'NDCG@5': '0.1573', 'HR@10': '0.3404', 'NDCG@10': '0.1912', 'HR@20': '0.4550', 'NDCG@20': '0.2202'}
2025-10-24 13:40:11,961 - EarlyStopping counter: 2 out of 10
2025-10-24 13:45:01,364 - {'epoch': 21, 'rec_loss': '5.2679'}
2025-10-24 13:45:03,114 - {'Epoch': 21, 'HR@5': '0.2364', 'NDCG@5': '0.1593', 'HR@10': '0.3452', 'NDCG@10': '0.1943', 'HR@20': '0.4563', 'NDCG@20': '0.2224'}
2025-10-24 13:45:03,115 - EarlyStopping counter: 3 out of 10
2025-10-24 13:49:50,939 - {'epoch': 22, 'rec_loss': '5.2630'}
2025-10-24 13:49:52,715 - {'Epoch': 22, 'HR@5': '0.2384', 'NDCG@5': '0.1613', 'HR@10': '0.3424', 'NDCG@10': '0.1947', 'HR@20': '0.4560', 'NDCG@20': '0.2233'}
2025-10-24 13:49:52,716 - EarlyStopping counter: 4 out of 10
2025-10-24 13:54:42,379 - {'epoch': 23, 'rec_loss': '5.2578'}
2025-10-24 13:54:44,153 - {'Epoch': 23, 'HR@5': '0.2373', 'NDCG@5': '0.1614', 'HR@10': '0.3396', 'NDCG@10': '0.1943', 'HR@20': '0.4608', 'NDCG@20': '0.2250'}
2025-10-24 13:54:44,153 - Validation score increased.  Saving model ...
2025-10-24 13:59:30,179 - {'epoch': 24, 'rec_loss': '5.2509'}
2025-10-24 13:59:31,885 - {'Epoch': 24, 'HR@5': '0.2386', 'NDCG@5': '0.1616', 'HR@10': '0.3399', 'NDCG@10': '0.1941', 'HR@20': '0.4608', 'NDCG@20': '0.2246'}
2025-10-24 13:59:31,886 - EarlyStopping counter: 1 out of 10
2025-10-24 14:04:20,640 - {'epoch': 25, 'rec_loss': '5.2473'}
2025-10-24 14:04:22,390 - {'Epoch': 25, 'HR@5': '0.2411', 'NDCG@5': '0.1639', 'HR@10': '0.3434', 'NDCG@10': '0.1969', 'HR@20': '0.4593', 'NDCG@20': '0.2263'}
2025-10-24 14:04:22,390 - Validation score increased.  Saving model ...
2025-10-24 14:09:05,843 - {'epoch': 26, 'rec_loss': '5.2426'}
2025-10-24 14:09:07,532 - {'Epoch': 26, 'HR@5': '0.2425', 'NDCG@5': '0.1624', 'HR@10': '0.3495', 'NDCG@10': '0.1968', 'HR@20': '0.4563', 'NDCG@20': '0.2238'}
2025-10-24 14:09:07,533 - EarlyStopping counter: 1 out of 10
2025-10-24 14:13:55,625 - {'epoch': 27, 'rec_loss': '5.2383'}
2025-10-24 14:13:57,355 - {'Epoch': 27, 'HR@5': '0.2328', 'NDCG@5': '0.1580', 'HR@10': '0.3464', 'NDCG@10': '0.1945', 'HR@20': '0.4575', 'NDCG@20': '0.2225'}
2025-10-24 14:13:57,355 - EarlyStopping counter: 2 out of 10
2025-10-24 14:18:46,696 - {'epoch': 28, 'rec_loss': '5.2334'}
2025-10-24 14:18:48,390 - {'Epoch': 28, 'HR@5': '0.2328', 'NDCG@5': '0.1573', 'HR@10': '0.3411', 'NDCG@10': '0.1923', 'HR@20': '0.4560', 'NDCG@20': '0.2214'}
2025-10-24 14:18:48,391 - EarlyStopping counter: 3 out of 10
2025-10-24 14:23:36,953 - {'epoch': 29, 'rec_loss': '5.2297'}
2025-10-24 14:23:38,692 - {'Epoch': 29, 'HR@5': '0.2389', 'NDCG@5': '0.1646', 'HR@10': '0.3447', 'NDCG@10': '0.1987', 'HR@20': '0.4558', 'NDCG@20': '0.2267'}
2025-10-24 14:23:38,693 - Validation score increased.  Saving model ...
2025-10-24 14:28:27,366 - {'epoch': 30, 'rec_loss': '5.2259'}
2025-10-24 14:28:29,111 - {'Epoch': 30, 'HR@5': '0.2439', 'NDCG@5': '0.1647', 'HR@10': '0.3450', 'NDCG@10': '0.1973', 'HR@20': '0.4632', 'NDCG@20': '0.2272'}
2025-10-24 14:28:29,112 - Validation score increased.  Saving model ...
2025-10-24 14:33:17,443 - {'epoch': 31, 'rec_loss': '5.2220'}
2025-10-24 14:33:19,148 - {'Epoch': 31, 'HR@5': '0.2404', 'NDCG@5': '0.1626', 'HR@10': '0.3445', 'NDCG@10': '0.1962', 'HR@20': '0.4591', 'NDCG@20': '0.2250'}
2025-10-24 14:33:19,148 - EarlyStopping counter: 1 out of 10
2025-10-24 14:38:09,637 - {'epoch': 32, 'rec_loss': '5.2188'}
2025-10-24 14:38:11,400 - {'Epoch': 32, 'HR@5': '0.2397', 'NDCG@5': '0.1630', 'HR@10': '0.3513', 'NDCG@10': '0.1990', 'HR@20': '0.4584', 'NDCG@20': '0.2260'}
2025-10-24 14:38:11,401 - EarlyStopping counter: 2 out of 10
2025-10-24 14:43:00,688 - {'epoch': 33, 'rec_loss': '5.2138'}
2025-10-24 14:43:02,464 - {'Epoch': 33, 'HR@5': '0.2427', 'NDCG@5': '0.1634', 'HR@10': '0.3455', 'NDCG@10': '0.1966', 'HR@20': '0.4654', 'NDCG@20': '0.2269'}
2025-10-24 14:43:02,465 - EarlyStopping counter: 3 out of 10
2025-10-24 14:47:52,978 - {'epoch': 34, 'rec_loss': '5.2102'}
2025-10-24 14:47:54,754 - {'Epoch': 34, 'HR@5': '0.2368', 'NDCG@5': '0.1590', 'HR@10': '0.3447', 'NDCG@10': '0.1939', 'HR@20': '0.4588', 'NDCG@20': '0.2226'}
2025-10-24 14:47:54,755 - EarlyStopping counter: 4 out of 10
2025-10-24 14:52:43,239 - {'epoch': 35, 'rec_loss': '5.2074'}
2025-10-24 14:52:44,924 - {'Epoch': 35, 'HR@5': '0.2338', 'NDCG@5': '0.1580', 'HR@10': '0.3407', 'NDCG@10': '0.1925', 'HR@20': '0.4581', 'NDCG@20': '0.2222'}
2025-10-24 14:52:44,925 - EarlyStopping counter: 5 out of 10
2025-10-24 14:57:34,380 - {'epoch': 36, 'rec_loss': '5.2043'}
2025-10-24 14:57:36,143 - {'Epoch': 36, 'HR@5': '0.2348', 'NDCG@5': '0.1594', 'HR@10': '0.3444', 'NDCG@10': '0.1948', 'HR@20': '0.4598', 'NDCG@20': '0.2239'}
2025-10-24 14:57:36,144 - EarlyStopping counter: 6 out of 10
2025-10-24 15:02:25,029 - {'epoch': 37, 'rec_loss': '5.2011'}
2025-10-24 15:02:26,805 - {'Epoch': 37, 'HR@5': '0.2343', 'NDCG@5': '0.1588', 'HR@10': '0.3439', 'NDCG@10': '0.1940', 'HR@20': '0.4588', 'NDCG@20': '0.2231'}
2025-10-24 15:02:26,806 - EarlyStopping counter: 7 out of 10
2025-10-24 15:07:08,794 - {'epoch': 38, 'rec_loss': '5.1964'}
2025-10-24 15:07:10,545 - {'Epoch': 38, 'HR@5': '0.2358', 'NDCG@5': '0.1620', 'HR@10': '0.3391', 'NDCG@10': '0.1952', 'HR@20': '0.4566', 'NDCG@20': '0.2250'}
2025-10-24 15:07:10,546 - EarlyStopping counter: 8 out of 10
2025-10-24 15:12:00,947 - {'epoch': 39, 'rec_loss': '5.1933'}
2025-10-24 15:12:02,657 - {'Epoch': 39, 'HR@5': '0.2359', 'NDCG@5': '0.1627', 'HR@10': '0.3454', 'NDCG@10': '0.1981', 'HR@20': '0.4588', 'NDCG@20': '0.2268'}
2025-10-24 15:12:02,658 - EarlyStopping counter: 9 out of 10
2025-10-24 15:16:51,595 - {'epoch': 40, 'rec_loss': '5.1920'}
2025-10-24 15:16:53,312 - {'Epoch': 40, 'HR@5': '0.2369', 'NDCG@5': '0.1592', 'HR@10': '0.3422', 'NDCG@10': '0.1931', 'HR@20': '0.4599', 'NDCG@20': '0.2229'}
2025-10-24 15:16:53,312 - EarlyStopping counter: 10 out of 10
2025-10-24 15:16:53,312 - Early stopping
2025-10-24 15:16:53,312 - ---------------Test Score---------------
2025-10-24 15:16:55,222 - {'Epoch': 0, 'HR@5': '0.2321', 'NDCG@5': '0.1577', 'HR@10': '0.3334', 'NDCG@10': '0.1904', 'HR@20': '0.4421', 'NDCG@20': '0.2179'}
2025-10-24 15:16:55,222 - WEFTRec_K_200_ML-1M_0.1_0.0005_0.6_8.log
2025-10-24 15:16:55,223 - {'Epoch': 0, 'HR@5': '0.2321', 'NDCG@5': '0.1577', 'HR@10': '0.3334', 'NDCG@10': '0.1904', 'HR@20': '0.4421', 'NDCG@20': '0.2179'}
